- name: install nginx
  ansible.builtin.import_role:
    name: common
    tasks_from: nginx-setup.yaml

- name: clear default html files
  ansible.builtin.file: 
    path: /usr/share/nginx/html
    state: absent

- name: create html directory
  ansible.builtin.file:
    path: /usr/share/nginx/html
    state: directory

- name: get data from url
  ansible.builtin.get_url:
    url: https://roboshop-artifacts.s3.amazonaws.com/frontend-v3.zip
    dest: /tmp/frontend.zip

- name: unzip catalogue
  ansible.builtin.unarchive:
    src: /tmp/frontend.zip
    dest: /usr/share/nginx/html
    remote_src: yes

- name: remove default nginx
  ansible.builtin.file:
    state: absent
    path: /etc/nginx/nginx.conf

- name: copy nginx conf file
  ansible.builtin.file:
    src: nginx.conf
    dest: /etc/nginx/nginx.conf

- name: start and enable nginx service
  ansible.builtin.service:
    name: nginx
    enabled: yes
    state: started